<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reset Password</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <div class="reset-container">
    <h2>Reset Password</h2>
    <input type="password" id="newPassword" placeholder="Enter new password" required />
    <button onclick="resetPassword()">Reset Password</button>
    <p id="message"></p>
  </div>

<script>
const BACKEND_URL = "http://localhost:8080/api/auth"; 
function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}



async function resetPassword() {
  const token = getQueryParam("token");
  const newPassword = document.getElementById("newPassword").value;
  const messageEl = document.getElementById("message");

  if (!token) {
    messageEl.textContent = "Invalid or missing token.";
    return;
  }

  if (!newPassword) {
    messageEl.textContent = "Please enter a new password.";
    return;
  }

  try {
    const res = await fetch(`${BACKEND_URL}/reset-password?token=${encodeURIComponent(token)}&newPassword=${encodeURIComponent(newPassword)}`, {
      method: "POST"
    });

    const text = await res.text();
    messageEl.textContent = text;
  } catch (err) {
    console.error(err);
    messageEl.textContent = "Something went wrong. Try again.";
  }
}
</script>

</body>
</html>
